## Required Variable


| Name       |Description                             |
|:-----------|:---------------------------------------|
| alert_email| Email address for infrastructure alerts|



## Optional Variable


| Name             |Default     |Description                                                                   | 
|:-----------------|:-----------|:-----------------------------------------------------------------------------|
| aws_region       |eu-west-1   |AWS region                                                                    |
| name             |wp-test     |Resource name prefix                                                          |
| max_tasks        |6           |Maximun ECS tasks                                                             |
| enable_https     |false       |Enable HTTPS using ACM and ALB (requires domain ownership)                    |
| domain_name      |null        |Base domain name (must be owned and DNS-manageable)                           |
| site_fqdn        |null        |Fully qualified domain name for WordPress (must be a subdomain of domain_name)|
| create_dns_alias |true        |Create Route53 A/AAAA alias records to the ALB (only if DNS is in Route53)    |

## Example terraform.tfvars
Default (HTTP only – works out of the box)

```hcl
aws_region  = "eu-west-1"
name        = "wp-topcom"
alert_email = "name@mail.com"
max_tasks   = 8
```

With HTTPS enabled (requires DNS ownership)
Important: site_fqdn must belong to domain_name. Mixing domains will cause ACM validation to fail.

```hcl
aws_region       = "eu-west-1"
name             = "wp-topcom"
alert_email      = "name@mail.com"
max_tasks        = 8
enable_https     = true
domain_name      = "example.com"
site_fqdn        = "wp.example.com"
create_dns_alias = true
```

## Autoscaling behavior

- Minimum tasks: 1
- Maximum tasks: max_tasks
- Scaling policy:
	- Target CPU utilization: 50%
	- Scale-out cooldown: 60s
	- Scale-in cooldown: 180s

EFS ensures WordPress uploads remain consistent across multiple tasks.


## Alerting

Email notifications are sent when:
- ECS tasks enter STOPPED state unexpectedly
- ALB 5XX error count exceeds threshold
- Target group has unhealthy hosts

Delivery mechanism:
```text
CloudWatch / EventBridge → SNS → Email
```

## Security

- ALB is public; ECS tasks accept traffic only from ALB security group
- Database is private; accessible only from ECS tasks
- EFS allows NFS access only from ECS tasks
- Database credentials stored in AWS Secrets Manager
- IAM roles follow least-privilege principles
- HTTPS is optional and requires DNS ownership by design